---
layout: post
title: "[180531] Activity 간 데이터를 주고받을 때의 제약사항"
date:   2018-05-31 17:55:25 +0900
---
하나의 액티비티에서 다른 액티비티로 데이터를 주고받기 위해 인텐트를 사용한다.<br>
아래는 A 액티비티에서 B 액티비티를 실행하는 과정의 예시이다.<br>
A 액티비티에서 인텐트를 작성하고 startActivity()를 통해 액티비티 매니저로 전달한다.<br>
액티비티 매니저는 전달받은 인텐트에서 정보를 추출해 패키지 매니저로 전달한다.<br>
패키지 매니저는 설치된 앱 중 수신받은 정보의 액티비티(B)가 존재하는지 확인한다.<br>
B 액티비티가 존재할 경우, 패키지 매니저는 액티비티 매니저로 실행할 액티비티(B)의 정보를 전달한다.<br>
액티비티 매니저는 제공받은 액티비티 정보를 통해 B 액티비티를 실행한다.(인텐트 전달)<br>
호출된 B 액티비티가 실행되고 인텐트를 수신한다.
<br>
<br>
위의 예시는 startActivity()로 A 액티비티가 일방적으로 B 액티비티로 정보(인텐트)를 전달하는 과정이다.<br>
startActivityForResult()는 A 액티비티와 B 액티비티의 데이터 교환을 위한 함수로 startActivity()와의 차이라면 onActivityResult()로 결과값을 전달받는 과정이 추가된다는 것이다.<br>
<br>
이번 포스팅에서는 startActivityForResult()의 데이터 전달이 제약되는 상황에 대해서 알아보려고 한다.<br>

<h3>서로 다른 태스크에서 실행된 액티비티 결과는 받을 수 없다</h3>
startActivityForResult()로 액티비티를 실행했더라도 onActivityResult()를 통해 결과를 받을 수 없는 경우를 의미한다.<br>
다시 말해, startActivityForResult()는 같은 태스크 내에 존재하는 액티비티의 결과만을 취할 수 있다는 것이다.<br>
왜 다른 태스크에서 실행된 액티비티 결과가 전달될 수 없는걸까? <br>
그 이유는 바로 태스크 순서가 달라질 수 있기 때문이다. <br>
예를 들어, A 앱과 B 앱이 존재한다고 해보자.<br>
홈에서 A 앱의 A1 액티비티를 실행한다. (홈 태스크 -> A 태스크)<br>
A 앱에서 B 앱의 B1 액티비티를 startActivityForResult()를 통해 실행한다.<br>
(홈 태스크[홈 액티비티] -> A 태스크[A1] -> B 태스크[B1])<br>
지금까지의 상황(B 앱의 B1 액티비티가 톱 액티비티)에서 이전키를 누르면 B 태스크가 종료되고 A 태스크의 A1으로 이동한다.<br>
이 흐름은 아주 자연스럽고 결과값의 전달도 아무런 이상이 없다.<br>
그러나 태스크 순서가 바뀌었을 때를 생각해보자<br>
B1 액티비티에서 홈키를 누르면 태스크의 순서가 바뀌게 된다. (A 태스크 -> B 태스크 -> 홈 태스크)<br>
홈 화면에서 '최근 실행한 앱'으로 다시 B 태스크를 활성화한다. (A 태스크 -> 홈 태스크 -> B 태스크)<br>
현재 화면엔 B1 액티비티가 보이게 되고, 여기서 이전키를 눌르면 A 앱이 아닌 홈 화면으로 돌아가게 된다.<br>
이 말은 B의 결과값이 A가 아닌 홈으로 전달된다는 것이다.<br>
이런 문제 때문에 안드로이드에서는 서로 다른 태스크의 액티비티 결과를 전달하지 않는다.<br>
