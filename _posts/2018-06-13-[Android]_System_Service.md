---
layout: post
title: "[180613] Activity 실행에 대한 두 가지 시스템 서비스"
date:   2018-06-13 17:55:25 +0900
---

<h3>패키지 매니저</h3>
앱을 설치하고 삭제하며, 설치된 모든 패키지 정보를 수집, 수집된 정보를 원하는 앱에 제공한다.<br>
모든 패키지 정보는 각 패키지마다 존재하는 AndroidManifest.xml 파일의 내용을 기반으로 설치 시점에 수집된다.<br>

<h3>액티비티 매니저</h3>
안드로이드의 4대 컴포넌트를 관리하며, 액티비티를 실행/종료하는 기능도 가진다.<br>
1. 앱의 실행<br>
앱의 생명주기에서 onCreate, onStart, onResume 같은 함수들은 액티비티 매니저가 호출한다.<br>
<br>
2. 앱의 종료<br>
액티비티 매니저는 앱의 실행뿐만 아니라 앱의 종료도 담당한다.<br>
사용자가 [이전] 키를 눌러 액티비티를 종료시킬 때의 onDestory 함수도 액티비티 매니저가 호출한다.<br>
<br>
3. 앱들 사이의 인텐트 전달<br>
액티비티 매니저는 앱들이 서로 데이터를 주고받을 때, 중간에서 데이터를 전달해주는 역할을 한다.<br>
예를 들어, 인스타그램이나 페이스북같은 SNS에 사진을 업로드할 때, 해당 SNS 앱과 갤러리 앱 사이에 직접적인 데이터 전달이 일어나는 것이 아니라 SNS 앱은 액티비티 매니저에게 인텐트를 보내고, 액티비티 매니저는 해당 인텐트를 갤러리 앱에 전달하는 것이다.<br>

<h3>액티비티가 실행되는 과정</h3><br>
\*두 개의 앱 a, b가 있고 A 액티비티에서 B 액티비티를 실행한다고 가정<br>

<img src="/assets/images/activitymanager.jpg" width="600" height="400">

1. A 액티비티에서 [B 실행] 버튼을 누른다.<br>
2. 버튼의 상호작용으로 인텐트가 작성된다. <startActivity(intent)><br>
3. startActivity 함수를 통해 인텐트를 액티비티 매니저에 전달하여 B 앱 실행 요청을 한다.<br>
4. 액티비티 매니저는 인텐트에 기록된 정보를 추출하여 패키지 매니저에 전달한다.<br>
5. 패키지 매니저는 설치된 앱 중 수신받은 정보의 액티비티가 존재하는지 확인한다. 존재한다면, 해당 액티비티 정보를 액티비티 매니저로 전달한다.<br>
6. 액티비티 매니저는 패키지 매니저로부터 받은 정보를 통해 B 액티비티를 실행하고 인텐트를 전달해 준다.<br>
7. B 액티비티가 실행되고 인텐트를 수신받는다.<br>



//4 ~ 6 과정은 시스템 서비스에서 일어나는 과정
